<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Simulation" href="simulation.html" /><link rel="prev" title="API Reference" href="index.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Forces - Cavity HOOMD 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=269f3e6a" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=269f3e6a" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #2980b9;
  --color-brand-content: #2980b9;
  --color-brand-visited: #9b59b6;
  --color-background-primary: #ffffff;
  --color-background-secondary: #f8f9fa;
  --color-background-hover: #efeff4;
  --color-background-hover--transparent: #efeff400;
  --color-background-border: #e1e4e5;
  --color-foreground-primary: #000000;
  --color-foreground-secondary: #5a5c63;
  --color-foreground-muted: #6c6c6c;
  --color-foreground-border: #878787;
  --color-api-background: #f8f9fa;
  --color-api-background-hover: #efeff4;
  --color-api-overall: #2980b9;
  --color-api-name: #2c3e50;
  --color-api-pre-name: #34495e;
  --color-api-paren: #6c6c6c;
  --color-api-keyword: #8e44ad;
  --color-admonition-background: transparent;
  --color-inline-code-background: #f1f2f3;
  --color-highlighted-background: #ffd43b;
  --color-highlighted-text: #000000;
  --color-guilabel-background: #ddeeff;
  --color-guilabel-border: #b3d4ff;
  --color-guilabel-text: #2c3e50;
  --color-kbd-background: #f9f9f9;
  --color-kbd-border: #d1d5da;
  --color-kbd-text: #2c3e50;
  --color-link: #2980b9;
  --color-link-underline: #2980b9;
  --color-link-hover: #1abc9c;
  --color-link-hover-underline: #1abc9c;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3498db;
  --color-brand-content: #3498db;
  --color-brand-visited: #bb86fc;
  --color-background-primary: #131416;
  --color-background-secondary: #1a1c23;
  --color-background-hover: #1e2124;
  --color-background-hover--transparent: #1e212400;
  --color-background-border: #303335;
  --color-foreground-primary: #ffffffcc;
  --color-foreground-secondary: #9ca0a5;
  --color-foreground-muted: #81868d;
  --color-foreground-border: #666666;
  --color-api-background: #1a1c23;
  --color-api-background-hover: #1e2124;
  --color-api-overall: #3498db;
  --color-api-name: #ecf0f1;
  --color-api-pre-name: #bdc3c7;
  --color-api-paren: #95a5a6;
  --color-api-keyword: #e74c3c;
  --color-admonition-background: transparent;
  --color-inline-code-background: #2c2c2c;
  --color-highlighted-background: #f39c12;
  --color-highlighted-text: #000000;
  --color-guilabel-background: #2c3e50;
  --color-guilabel-border: #34495e;
  --color-guilabel-text: #ecf0f1;
  --color-kbd-background: #2c2c2c;
  --color-kbd-border: #525252;
  --color-kbd-text: #ecf0f1;
  --color-link: #3498db;
  --color-link-underline: #3498db;
  --color-link-hover: #1abc9c;
  --color-link-hover-underline: #1abc9c;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3498db;
  --color-brand-content: #3498db;
  --color-brand-visited: #bb86fc;
  --color-background-primary: #131416;
  --color-background-secondary: #1a1c23;
  --color-background-hover: #1e2124;
  --color-background-hover--transparent: #1e212400;
  --color-background-border: #303335;
  --color-foreground-primary: #ffffffcc;
  --color-foreground-secondary: #9ca0a5;
  --color-foreground-muted: #81868d;
  --color-foreground-border: #666666;
  --color-api-background: #1a1c23;
  --color-api-background-hover: #1e2124;
  --color-api-overall: #3498db;
  --color-api-name: #ecf0f1;
  --color-api-pre-name: #bdc3c7;
  --color-api-paren: #95a5a6;
  --color-api-keyword: #e74c3c;
  --color-admonition-background: transparent;
  --color-inline-code-background: #2c2c2c;
  --color-highlighted-background: #f39c12;
  --color-highlighted-text: #000000;
  --color-guilabel-background: #2c3e50;
  --color-guilabel-border: #34495e;
  --color-guilabel-text: #ecf0f1;
  --color-kbd-background: #2c2c2c;
  --color-kbd-border: #525252;
  --color-kbd-text: #ecf0f1;
  --color-link: #3498db;
  --color-link-underline: #3498db;
  --color-link-hover: #1abc9c;
  --color-link-hover-underline: #1abc9c;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Cavity HOOMD 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Cavity HOOMD 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/index.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/basic_usage.html">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/advanced_features.html">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/parameter_sweeps.html">Parameter Sweeps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/performance.html">Performance</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/hoomd.cavitymd.forces.html">hoomd.cavitymd.forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/hoomd.cavitymd.simulation.html">hoomd.cavitymd.simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/hoomd.cavitymd.analysis.html">hoomd.cavitymd.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/hoomd.cavitymd.utils.html">hoomd.cavitymd.utils</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/muhammadhasyim/cav-hoomd/blob/main/docs/api/forces.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/muhammadhasyim/cav-hoomd/edit/main/docs/api/forces.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="forces">
<h1>Forces<a class="headerlink" href="#forces" title="Link to this heading">¶</a></h1>
<p>This module provides force implementations for cavity-matter interactions.</p>
<section id="core-force-classes">
<h2>Core Force Classes<a class="headerlink" href="#core-force-classes" title="Link to this heading">¶</a></h2>
<section id="cavityforce">
<h3>CavityForce<a class="headerlink" href="#cavityforce" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hoomd.cavitymd.</span></span><span class="sig-name descname"><span class="pre">CavityForce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">couplstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omegac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phmass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/forces.html#CavityForce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.CavityForce" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://hoomd-blue.readthedocs.io/en/stable/hoomd/md/force/force.html#hoomd.md.force.Force" title="(in HOOMD-blue v5.3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Force</span></code></a></p>
<p>Cavity force with automatic C++/Python fallback.</p>
<p>Implements the cavity-molecule interaction force from the Hamiltonian:
H = (1/2) * K * q² + g * q · d + (g²/2K) * d²</p>
<p>where q is the cavity mode position, d is the molecular dipole moment,
g is the coupling strength, and K = phmass * omegac².</p>
<section id="parameters">
<h4>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>kvector<span class="classifier">array_like</span></dt><dd><p>Cavity mode wave vector (currently not used but kept for compatibility)</p>
</dd>
<dt>couplstr<span class="classifier">float</span></dt><dd><p>Coupling strength g in atomic units</p>
</dd>
<dt>omegac<span class="classifier">float</span></dt><dd><p>Cavity frequency in atomic units (Hartree)</p>
</dd>
<dt>phmass<span class="classifier">float, optional</span></dt><dd><p>Photon mass, determines K = phmass * omegac² (default: 1.0)</p>
</dd>
<dt>force_python<span class="classifier">bool, optional</span></dt><dd><p>Force use of Python implementation even if C++ is available (default: False)</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.__init__" title="hoomd.cavitymd.CavityForce.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.harmonic_energy" title="hoomd.cavitymd.CavityForce.harmonic_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">harmonic_energy</span></code></a></p></td>
<td><p>(1/2) * K * q²</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.coupling_energy" title="hoomd.cavitymd.CavityForce.coupling_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coupling_energy</span></code></a></p></td>
<td><p>g * (q · d)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.dipole_self_energy" title="hoomd.cavitymd.CavityForce.dipole_self_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dipole_self_energy</span></code></a></p></td>
<td><p>(g²/2K) * d²</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.total_cavity_energy" title="hoomd.cavitymd.CavityForce.total_cavity_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_cavity_energy</span></code></a></p></td>
<td><p>sum of all energy components</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Properties</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.implementation" title="hoomd.cavitymd.CavityForce.implementation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">implementation</span></code></a></p></td>
<td><p>Return the current implementation being used ('cpp', 'cuda', or 'python').</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.energy" title="hoomd.cavitymd.CavityForce.energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">energy</span></code></a></p></td>
<td><p>Override HOOMD's base Force.energy property to return sum of components instead of per-particle energies</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.cavitymd.CavityForce.forces" title="hoomd.cavitymd.CavityForce.forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forces</span></code></a></p></td>
<td><p>Get forces array (for HOOMD compatibility)</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">couplstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omegac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phmass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/forces.html#CavityForce.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.CavityForce.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.implementation">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">implementation</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.implementation" title="Link to this definition">¶</a></dt>
<dd><p>Return the current implementation being used (‘cpp’, ‘cuda’, or ‘python’).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.harmonic_energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">harmonic_energy</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.harmonic_energy" title="Link to this definition">¶</a></dt>
<dd><p>(1/2) * K * q²</p>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”scalar”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Harmonic oscillator energy component</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.coupling_energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coupling_energy</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.coupling_energy" title="Link to this definition">¶</a></dt>
<dd><p>g * (q · d)</p>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”scalar”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coupling interaction energy component</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.dipole_self_energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dipole_self_energy</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.dipole_self_energy" title="Link to this definition">¶</a></dt>
<dd><p>(g²/2K) * d²</p>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”scalar”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dipole self-energy component</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.total_cavity_energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_cavity_energy</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.total_cavity_energy" title="Link to this definition">¶</a></dt>
<dd><p>sum of all energy components</p>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”scalar”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total cavity energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.energy" title="Link to this definition">¶</a></dt>
<dd><p>Override HOOMD’s base Force.energy property to return sum of components instead of per-particle energies</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.forces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forces</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.forces" title="Link to this definition">¶</a></dt>
<dd><p>Get forces array (for HOOMD compatibility)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.__dir__">
<span class="sig-name descname"><span class="pre">__dir__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.__dir__" title="Link to this definition">¶</a></dt>
<dd><p>Expose all attributes for dynamic querying in notebooks and IDEs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.additional_energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">additional_energy</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.additional_energy" title="Link to this definition">¶</a></dt>
<dd><p>Additional energy term <span class="math notranslate nohighlight">\(U_\mathrm{additional}\)</span>         <span class="math notranslate nohighlight">\([\mathrm{energy}]\)</span>.</p>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”scalar”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.additional_virial">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">additional_virial</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.additional_virial" title="Link to this definition">¶</a></dt>
<dd><p>Additional virial tensor         term <span class="math notranslate nohighlight">\(W_\mathrm{additional}\)</span> <span class="math notranslate nohighlight">\([\mathrm{energy}]\)</span>.</p>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”sequence”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(1, 6) <cite>numpy.ndarray</cite> of <code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.cpu_local_force_arrays">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cpu_local_force_arrays</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.cpu_local_force_arrays" title="Link to this definition">¶</a></dt>
<dd><p>Local force arrays on the CPU.</p>
<p>Provides direct access to the force, potential energy, torque, and
virial data of the particles in the system on the cpu through a context
manager. All data is MPI rank-local.</p>
<p>The <cite>hoomd.md.data.ForceLocalAccess</cite> object returned by this property
has four arrays through which one can modify the force data:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The local arrays are read only for built-in forces. Use <cite>Custom</cite> to
implement custom forces.</p>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_local_force_arrays</span> <span class="k">as</span> <span class="n">arrays</span><span class="p">:</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">force</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">potential_energy</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">torque</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">virial</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://hoomd-blue.readthedocs.io/en/stable/hoomd/md/data/forcelocalaccess.html#hoomd.md.data.ForceLocalAccess" title="(in HOOMD-blue v5.3.0)">hoomd.md.data.ForceLocalAccess</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.energies">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energies</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.energies" title="Link to this definition">¶</a></dt>
<dd><p>Energy         contribution <span class="math notranslate nohighlight">\(U_i\)</span> from each particle <span class="math notranslate nohighlight">\([\mathrm{energy}]\)</span>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>In MPI parallel execution, the array is available on rank 0 only.
<cite>energies</cite> is <cite>None</cite> on ranks &gt;= 1.</p>
</div>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”particle”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<em>N_particles</em>, ) <cite>numpy.ndarray</cite> of <code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.gpu_local_force_arrays">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpu_local_force_arrays</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.gpu_local_force_arrays" title="Link to this definition">¶</a></dt>
<dd><p>Local force arrays on the GPU.</p>
<p>Provides direct access to the force, potential energy, torque, and
virial data of the particles in the system on the gpu through a context
manager. All data is MPI rank-local.</p>
<p>The <cite>hoomd.md.data.ForceLocalAccessGPU</cite> object returned by this property
has four arrays through which one can modify the force data:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The local arrays are read only for built-in forces. Use <cite>Custom</cite> to
implement custom forces.</p>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpu_local_force_arrays</span> <span class="k">as</span> <span class="n">arrays</span><span class="p">:</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">force</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">potential_energy</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">torque</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">arrays</span><span class="o">.</span><span class="n">virial</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GPU local force data is not available if the chosen device for the
simulation is <cite>hoomd.device.CPU</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://hoomd-blue.readthedocs.io/en/stable/hoomd/md/data/forcelocalaccessgpu.html#hoomd.md.data.ForceLocalAccessGPU" title="(in HOOMD-blue v5.3.0)">hoomd.md.data.ForceLocalAccessGPU</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.is_tuning_complete">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_tuning_complete</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.is_tuning_complete" title="Link to this definition">¶</a></dt>
<dd><p>Check if kernel parameter tuning is complete.</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> when tuning is complete and <cite>kernel_parameters</cite> has locked
optimal parameters for all active kernels used by this object.</p>
<p class="rubric">Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="ow">not</span> <span class="n">operation</span><span class="o">.</span><span class="n">is_tuning_complete</span><span class="p">:</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.kernel_parameters">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_parameters</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.kernel_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Kernel parameters.</p>
<p>The dictionary maps GPU kernel names to tuples of integers that control
how the kernel executes on the GPU. These values will change during the
tuning process and remain static after tuning completes. Set the kernel
parameters for one or more kernels to force specific values and stop
tuning.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The keys and valid values in this dictionary depend on the hardware
device, the HOOMD-blue version, and the value of class attributes.
Keys and/or valid values may change even with new patch releases of
HOOMD-blue.</p>
<p>Provided that you use the same HOOMD-blue binary on the same
hardware and execute a script with the same parameters, you may save
the tuned values from one run and load them in the next.</p>
</div>
<p class="rubric">Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">kernel_parameters</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">kernel_parameters</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operation</span><span class="o">.</span><span class="n">kernel_parameters</span> <span class="o">=</span> <span class="n">kernel_parameters</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.loggables">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loggables</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.loggables" title="Link to this definition">¶</a></dt>
<dd><p>Name, category mapping of loggable quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.torques">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">torques</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.torques" title="Link to this definition">¶</a></dt>
<dd><p>The torque         <span class="math notranslate nohighlight">\(\vec{\tau}_i\)</span> applied to each particle         <span class="math notranslate nohighlight">\([\mathrm{force} \cdot \mathrm{length}]\)</span>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>In MPI parallel execution, the array is available on rank 0 only.
<cite>torques</cite> is <cite>None</cite> on ranks &gt;= 1.</p>
</div>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”particle”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<em>N_particles</em>, 3) <cite>numpy.ndarray</cite> of <code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.tune_kernel_parameters">
<span class="sig-name descname"><span class="pre">tune_kernel_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.tune_kernel_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Start tuning kernel parameters.</p>
<p>After calling <cite>tune_kernel_parameters</cite>, <cite>AutotunedObject</cite> will vary the
kernel parameters in subsequent time steps, check the run time of each,
and lock to the fastest performing parameters after the scan is
complete.</p>
<p class="rubric">Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operation</span><span class="o">.</span><span class="n">tune_kernel_parameters</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.virials">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">virials</span></span><a class="headerlink" href="#hoomd.cavitymd.CavityForce.virials" title="Link to this definition">¶</a></dt>
<dd><p>Virial tensor         contribution <span class="math notranslate nohighlight">\(W_i\)</span> from each particle <span class="math notranslate nohighlight">\([\mathrm{energy}]\)</span>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>To improve performance <cite>Force</cite> objects only compute virials when
needed. When not computed, <cite>virials</cite> is <cite>None</cite>. Virials are computed
on every step when using a <cite>md.methods.ConstantPressure</cite>
integrator, on steps where a writer is triggered (such as
<cite>write.GSD</cite> which may log pressure or virials), or when
<cite>Simulation.always_compute_pressure</cite> is <cite>True</cite>.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>In MPI parallel execution, the array is available on rank 0 only.
<cite>virials</cite> is <cite>None</cite> on ranks &gt;= 1.</p>
</div>
<p>(<cite>Loggable &lt;hoomd.logging.Logger&gt;</cite>: category=”particle”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<em>N_particles</em>, 6) <cite>numpy.ndarray</cite> of <code class="docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hoomd.cavitymd.CavityForce.set_forces">
<span class="sig-name descname"><span class="pre">set_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/forces.html#CavityForce.set_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.CavityForce.set_forces" title="Link to this definition">¶</a></dt>
<dd><p>For Python implementation compatibility</p>
</dd></dl>

</section>
</dd></dl>

</section>
</section>
<section id="module-hoomd.cavitymd.cavity_force_python">
<span id="python-implementation"></span><h2>Python Implementation<a class="headerlink" href="#module-hoomd.cavitymd.cavity_force_python" title="Link to this heading">¶</a></h2>
<p>Pure Python cavity force implementation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hoomd.cavitymd.cavity_force_python.unwrap_positions">
<span class="sig-prename descclassname"><span class="pre">hoomd.cavitymd.cavity_force_python.</span></span><span class="sig-name descname"><span class="pre">unwrap_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/cavity_force_python.html#unwrap_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.cavity_force_python.unwrap_positions" title="Link to this definition">¶</a></dt>
<dd><p>Unwrap particle positions across periodic boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> – Array of wrapped positions (N x 3)</p></li>
<li><p><strong>images</strong> – Array of image flags (N x 3)</p></li>
<li><p><strong>box_lengths</strong> – Array of box dimensions (3,)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of unwrapped positions (N x 3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hoomd.cavitymd.cavity_force_python.CavityForcePython">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hoomd.cavitymd.cavity_force_python.</span></span><span class="sig-name descname"><span class="pre">CavityForcePython</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">couplstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omegac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phmass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/cavity_force_python.html#CavityForcePython"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://hoomd-blue.readthedocs.io/en/stable/hoomd/md/force/custom.html#hoomd.md.force.Custom" title="(in HOOMD-blue v5.3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Custom</span></code></a></p>
<p>Pure Python implementation of the cavity force.</p>
<p>This serves as a fallback when the C++/CUDA implementations are not available.
Implements the same physics as the optimized versions but with Python performance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="hoomd.cavitymd.cavity_force_python.CavityForcePython.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">couplstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omegac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phmass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/cavity_force_python.html#CavityForcePython.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hoomd.cavitymd.cavity_force_python.CavityForcePython.total_cavity_energy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_cavity_energy</span></span><a class="headerlink" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython.total_cavity_energy" title="Link to this definition">¶</a></dt>
<dd><p>sum of all components</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total cavity energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hoomd.cavitymd.cavity_force_python.CavityForcePython.set_forces">
<span class="sig-name descname"><span class="pre">set_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hoomd/cavitymd/cavity_force_python.html#CavityForcePython.set_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython.set_forces" title="Link to this definition">¶</a></dt>
<dd><p>Compute cavity forces and potential energy.</p>
<p>This is called by HOOMD at each timestep to compute forces.
Implements the cavity-molecule interaction Hamiltonian.</p>
</dd></dl>

</dd></dl>

</section>
<section id="usage-examples">
<h2>Usage Examples<a class="headerlink" href="#usage-examples" title="Link to this heading">¶</a></h2>
<section id="basic-cavity-force-setup">
<h3>Basic Cavity Force Setup<a class="headerlink" href="#basic-cavity-force-setup" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">hoomd.cavitymd</span> <span class="kn">import</span> <span class="n">CavityForce</span>

<span class="c1"># Create a cavity force with specified parameters</span>
<span class="n">cavity_force</span> <span class="o">=</span> <span class="n">CavityForce</span><span class="p">(</span>
    <span class="n">kvector</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>      <span class="c1"># Wave vector direction</span>
    <span class="n">couplstr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>          <span class="c1"># Coupling strength</span>
    <span class="n">omegac</span><span class="o">=</span><span class="mf">0.092</span><span class="p">,</span>           <span class="c1"># Cavity frequency (atomic units)</span>
    <span class="n">phmass</span><span class="o">=</span><span class="mf">1.0</span>              <span class="c1"># Photon mass</span>
<span class="p">)</span>

<span class="c1"># Add to integrator forces</span>
<span class="n">forces</span> <span class="o">=</span> <span class="p">[</span><span class="n">cavity_force</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">hoomd</span><span class="o">.</span><span class="n">md</span><span class="o">.</span><span class="n">Integrator</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">forces</span><span class="o">=</span><span class="n">forces</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="energy-components">
<h3>Energy Components<a class="headerlink" href="#energy-components" title="Link to this heading">¶</a></h3>
<p>The cavity force provides access to individual energy components:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># After running simulation</span>
<span class="n">harmonic_energy</span> <span class="o">=</span> <span class="n">cavity_force</span><span class="o">.</span><span class="n">harmonic_energy</span>
<span class="n">coupling_energy</span> <span class="o">=</span> <span class="n">cavity_force</span><span class="o">.</span><span class="n">coupling_energy</span>
<span class="n">dipole_self_energy</span> <span class="o">=</span> <span class="n">cavity_force</span><span class="o">.</span><span class="n">dipole_self_energy</span>
<span class="n">total_energy</span> <span class="o">=</span> <span class="n">cavity_force</span><span class="o">.</span><span class="n">total_cavity_energy</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Harmonic: </span><span class="si">{</span><span class="n">harmonic_energy</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Coupling: </span><span class="si">{</span><span class="n">coupling_energy</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Self-energy: </span><span class="si">{</span><span class="n">dipole_self_energy</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total: </span><span class="si">{</span><span class="n">total_energy</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="implementation-selection">
<h3>Implementation Selection<a class="headerlink" href="#implementation-selection" title="Link to this heading">¶</a></h3>
<p>The force automatically selects the best available implementation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check which implementation is being used</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using </span><span class="si">{</span><span class="n">cavity_force</span><span class="o">.</span><span class="n">implementation</span><span class="si">}</span><span class="s2"> implementation&quot;</span><span class="p">)</span>

<span class="c1"># Force Python implementation for debugging</span>
<span class="n">cavity_force_python</span> <span class="o">=</span> <span class="n">CavityForce</span><span class="p">(</span>
    <span class="n">kvector</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">couplstr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">omegac</span><span class="o">=</span><span class="mf">0.092</span><span class="p">,</span>
    <span class="n">force_python</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Force Python implementation</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Link to this heading">¶</a></h2>
<section id="hamiltonian">
<h3>Hamiltonian<a class="headerlink" href="#hamiltonian" title="Link to this heading">¶</a></h3>
<p>The cavity force implements the interaction Hamiltonian:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[H_{cav} = \frac{1}{2}K q^2 + g \vec{q} \cdot \vec{d} + \frac{g^2}{2K} d^2\]</div>
</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K = m_{\text{ph}} \omega_c^2\)</span> is the cavity spring constant</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is the cavity mode coordinate</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{d}\)</span> is the molecular dipole moment</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is the coupling strength</p></li>
</ul>
</section>
<section id="id1">
<h3>Energy Components<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p><strong>Harmonic Energy</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E_{\text{harm}} = \frac{1}{2}K q^2\]</div>
</div>
<p>The harmonic oscillator energy of the cavity mode.</p>
<p><strong>Coupling Energy</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E_{\text{coup}} = g \vec{q} \cdot \vec{d}\]</div>
</div>
<p>The direct dipole-cavity interaction energy.</p>
<p><strong>Dipole Self-Energy</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E_{\text{self}} = \frac{g^2}{2K} d^2\]</div>
</div>
<p>The dipole self-energy correction due to cavity coupling.</p>
</section>
<section id="id2">
<h3>Forces<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>The forces on particles are derived from the energy gradients:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{F}_i = -\frac{\partial H_{cav}}{\partial \vec{r}_i}\]</div>
</div>
<p>For molecular particles:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{F}_i = -g q_i \vec{q} - \frac{g^2}{K} q_i \vec{d}\]</div>
</div>
<p>For the cavity particle:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{F}_{cav} = -K \vec{q} - g \vec{d}\]</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="simulation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Simulation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">API Reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Cavity HOOMD Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Forces</a><ul>
<li><a class="reference internal" href="#core-force-classes">Core Force Classes</a><ul>
<li><a class="reference internal" href="#cavityforce">CavityForce</a><ul>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce"><code class="docutils literal notranslate"><span class="pre">CavityForce</span></code></a><ul>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.__init__"><code class="docutils literal notranslate"><span class="pre">CavityForce.__init__()</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.implementation"><code class="docutils literal notranslate"><span class="pre">CavityForce.implementation</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.harmonic_energy"><code class="docutils literal notranslate"><span class="pre">CavityForce.harmonic_energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.coupling_energy"><code class="docutils literal notranslate"><span class="pre">CavityForce.coupling_energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.dipole_self_energy"><code class="docutils literal notranslate"><span class="pre">CavityForce.dipole_self_energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.total_cavity_energy"><code class="docutils literal notranslate"><span class="pre">CavityForce.total_cavity_energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.energy"><code class="docutils literal notranslate"><span class="pre">CavityForce.energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.forces"><code class="docutils literal notranslate"><span class="pre">CavityForce.forces</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.__dir__"><code class="docutils literal notranslate"><span class="pre">CavityForce.__dir__()</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.additional_energy"><code class="docutils literal notranslate"><span class="pre">CavityForce.additional_energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.additional_virial"><code class="docutils literal notranslate"><span class="pre">CavityForce.additional_virial</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.cpu_local_force_arrays"><code class="docutils literal notranslate"><span class="pre">CavityForce.cpu_local_force_arrays</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.energies"><code class="docutils literal notranslate"><span class="pre">CavityForce.energies</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.gpu_local_force_arrays"><code class="docutils literal notranslate"><span class="pre">CavityForce.gpu_local_force_arrays</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.is_tuning_complete"><code class="docutils literal notranslate"><span class="pre">CavityForce.is_tuning_complete</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.kernel_parameters"><code class="docutils literal notranslate"><span class="pre">CavityForce.kernel_parameters</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.loggables"><code class="docutils literal notranslate"><span class="pre">CavityForce.loggables</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.torques"><code class="docutils literal notranslate"><span class="pre">CavityForce.torques</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.tune_kernel_parameters"><code class="docutils literal notranslate"><span class="pre">CavityForce.tune_kernel_parameters()</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.virials"><code class="docutils literal notranslate"><span class="pre">CavityForce.virials</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.CavityForce.set_forces"><code class="docutils literal notranslate"><span class="pre">CavityForce.set_forces()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-hoomd.cavitymd.cavity_force_python">Python Implementation</a><ul>
<li><a class="reference internal" href="#hoomd.cavitymd.cavity_force_python.unwrap_positions"><code class="docutils literal notranslate"><span class="pre">unwrap_positions()</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython"><code class="docutils literal notranslate"><span class="pre">CavityForcePython</span></code></a><ul>
<li><a class="reference internal" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython.__init__"><code class="docutils literal notranslate"><span class="pre">CavityForcePython.__init__()</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython.total_cavity_energy"><code class="docutils literal notranslate"><span class="pre">CavityForcePython.total_cavity_energy</span></code></a></li>
<li><a class="reference internal" href="#hoomd.cavitymd.cavity_force_python.CavityForcePython.set_forces"><code class="docutils literal notranslate"><span class="pre">CavityForcePython.set_forces()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#usage-examples">Usage Examples</a><ul>
<li><a class="reference internal" href="#basic-cavity-force-setup">Basic Cavity Force Setup</a></li>
<li><a class="reference internal" href="#energy-components">Energy Components</a></li>
<li><a class="reference internal" href="#implementation-selection">Implementation Selection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#theory">Theory</a><ul>
<li><a class="reference internal" href="#hamiltonian">Hamiltonian</a></li>
<li><a class="reference internal" href="#id1">Energy Components</a></li>
<li><a class="reference internal" href="#id2">Forces</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=4ebf8126"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=d1c4098b"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "displayMath": [["$$", "$$"], ["\\[", "\\]"]], "packages": ["base", "ams", "autoload", "color", "physics"]}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>